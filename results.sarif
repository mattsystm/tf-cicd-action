{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "2.3.349", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AWS_79", "name": "Ensure Instance Metadata Service Version 1 is not enabled", "shortDescription": {"text": "Ensure Instance Metadata Service Version 1 is not enabled"}, "fullDescription": {"text": "Ensure Instance Metadata Service Version 1 is not enabled"}, "help": {"text": "Ensure Instance Metadata Service Version 1 is not enabled\nResource: aws_instance.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-31.html"}, {"id": "CKV_AWS_126", "name": "Ensure that detailed monitoring is enabled for EC2 instances", "shortDescription": {"text": "Ensure that detailed monitoring is enabled for EC2 instances"}, "fullDescription": {"text": "Ensure that detailed monitoring is enabled for EC2 instances"}, "help": {"text": "Ensure that detailed monitoring is enabled for EC2 instances\nResource: aws_instance.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances.html"}, {"id": "CKV_AWS_135", "name": "Ensure that EC2 is EBS optimized", "shortDescription": {"text": "Ensure that EC2 is EBS optimized"}, "fullDescription": {"text": "Ensure that EC2 is EBS optimized"}, "help": {"text": "Ensure that EC2 is EBS optimized\nResource: aws_instance.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized.html"}, {"id": "CKV_AWS_8", "name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "shortDescription": {"text": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"}, "fullDescription": {"text": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"}, "help": {"text": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted\nResource: aws_instance.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-13.html"}, {"id": "CKV_AWS_23", "name": "Ensure every security groups rule has a description", "shortDescription": {"text": "Ensure every security groups rule has a description"}, "fullDescription": {"text": "Ensure every security groups rule has a description"}, "help": {"text": "Ensure every security groups rule has a description\nResource: aws_security_group.web-sg"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-31.html"}, {"id": "CKV2_AWS_41", "name": "Ensure an IAM role is attached to EC2 instance", "shortDescription": {"text": "Ensure an IAM role is attached to EC2 instance"}, "fullDescription": {"text": "Ensure an IAM role is attached to EC2 instance"}, "help": {"text": "Ensure an IAM role is attached to EC2 instance\nResource: aws_instance.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance.html"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AWS_79", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure Instance Metadata Service Version 1 is not enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 39, "endLine": 52, "snippet": {"text": "resource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_126", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure that detailed monitoring is enabled for EC2 instances"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 39, "endLine": 52, "snippet": {"text": "resource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_135", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure that EC2 is EBS optimized"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 39, "endLine": 52, "snippet": {"text": "resource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_8", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 39, "endLine": 52, "snippet": {"text": "resource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure every security groups rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 54, "endLine": 69, "snippet": {"text": "resource \"aws_security_group\" \"web-sg\" {\n  name = \"${random_pet.sg.id}-sg\"\n  ingress {\n    from_port   = 8080\n    to_port     = 8080\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n  // connectivity to ubuntu mirrors is required to run `apt-get update` and `apt-get install apache2`\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_41", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure an IAM role is attached to EC2 instance"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "terraform/main.tf"}, "region": {"startLine": 39, "endLine": 52, "snippet": {"text": "resource \"aws_instance\" \"web\" {\n  ami                    = data.aws_ami.ubuntu.id\n  instance_type          = \"t2.micro\"\n  vpc_security_group_ids = [aws_security_group.web-sg.id]\n\n  user_data = <<-EOF\n              #!/bin/bash\n              apt-get update\n              apt-get install -y apache2\n              sed -i -e 's/80/8080/' /etc/apache2/ports.conf\n              echo \"Hello World\" > /var/www/html/index.html\n              systemctl restart apache2\n              EOF\n}\n"}}}}]}]}]}